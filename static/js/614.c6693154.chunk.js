"use strict";(self.webpackChunke_commer_react=self.webpackChunke_commer_react||[]).push([[614],{614:(e,t,a)=>{a.r(t),a.d(t,{default:()=>c});var o=a(43),r=a(216),s=a(579);function c(e){let{darkMode:t=!1}=e;const a=(0,r.Zp)(),[c,i]=(0,o.useState)(null),[l,n]=(0,o.useState)(!0),[d,m]=(0,o.useState)(""),[g,u]=(0,o.useState)(!1),[p,h]=(0,o.useState)(!1),[y,x]=(0,o.useState)(!1),[j,f]=(0,o.useState)(!1),[v,N]=(0,o.useState)(!1),[S,w]=(0,o.useState)([]),[b,I]=(0,o.useState)(["electronics","clothing","books","home","sports","other"]),[C,E]=(0,o.useState)(""),[k,P]=(0,o.useState)({title:"",price:"",quantity:1,image:"",description:"",category:"electronics"}),[q,A]=(0,o.useState)(null),T=["yahiapro400@gmail.com","yahiacool2009@gmail.com"],U=()=>{const e=localStorage.getItem("currentUserEmail")||localStorage.getItem("loggedInUser")||localStorage.getItem("userEmail");return e&&T.includes(e)},O=()=>{const e=localStorage.getItem("currentUserEmail")||localStorage.getItem("loggedInUser")||localStorage.getItem("userEmail");return e&&T.includes(e)};(0,o.useEffect)(()=>{const e=localStorage.getItem("currentUserEmail")||localStorage.getItem("loggedInUser")||localStorage.getItem("userEmail");if(!e){return 0===JSON.parse(localStorage.getItem("ecommerce_users")||"[]").length?(i({email:"admin@gmail.com"}),_(),D(),void n(!1)):void a("/login")}const t=JSON.parse(localStorage.getItem("ecommerce_users")||"[]").find(t=>t.email===e);if(!t){return["yahiapro400@gmail.com","yahiacool2009@gmail.com","admin-test@gmail.com","admin@gmail.com"].includes(e)?(i({email:e}),_(),D(),void n(!1)):void a("/login")}if(!["yahiapro400@gmail.com","yahiacool2009@gmail.com","admin-test@gmail.com","admin@gmail.com"].includes(t.email))return void a("/");i(t),_(),D(),setTimeout(()=>{S.forEach(e=>{e.image&&((new Image).src=e.image)})},100);try{const e=JSON.parse(localStorage.getItem("ecommerce_products")||"[]");if(e.length>50){const t=e.slice(-50);localStorage.setItem("ecommerce_products",JSON.stringify(t)),console.log("\ud83e\uddf9 Auto-cleanup: Reduced products from",e.length,"to",t.length)}}catch(s){console.error("Error during auto-cleanup:",s)}n(!1);const o=e=>{"ecommerce_products"===e.key&&(clearTimeout(window.storageTimeout),window.storageTimeout=setTimeout(()=>{_()},500))};window.addEventListener("storage",o);const r=e=>{e.target.closest(".category-selector")||N(!1)};return document.addEventListener("mousedown",r),()=>{window.removeEventListener("storage",o),document.removeEventListener("mousedown",r),clearTimeout(window.storageTimeout)}},[a]);const _=()=>{try{const e=localStorage.getItem("ecommerce_products")||localStorage.getItem("products");if(e){const t=JSON.parse(e);w(t),console.log("\ud83d\udd0d AddProducts.js: Loaded products:",t.length)}}catch(e){console.error("Error loading products:",e),w([])}},D=()=>{try{const e=localStorage.getItem("ecommerce_categories");if(e){const t=JSON.parse(e);I(t)}}catch(e){console.error("Error loading categories:",e)}},F=e=>{const{name:t,value:a}=e.target;P(e=>({...e,[t]:a}))},$=e=>{const{name:t,value:a}=e.target;A(e=>({...e,[t]:a}))},J=()=>{P({title:"",price:"",quantity:1,image:"",description:"",category:"electronics"}),m("Form cleared successfully!"),setTimeout(()=>m(""),3e3)};if(l)return(0,s.jsx)("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",background:"#f5f7fa"},children:(0,s.jsxs)("div",{style:{textAlign:"center",color:"#666"},children:[(0,s.jsx)("div",{style:{width:"40px",height:"40px",border:"4px solid #f3f3f3",borderTop:"4px solid #667eea",borderRadius:"50%",animation:"spin 1s linear infinite",margin:"0 auto 20px"}}),(0,s.jsx)("p",{children:"Loading..."})]})});const L=localStorage.getItem("currentUserEmail")||localStorage.getItem("loggedInUser")||localStorage.getItem("userEmail"),B=JSON.parse(localStorage.getItem("users")||"[]");return!L&&B.length>0?(0,s.jsxs)("div",{className:"access-denied",children:[(0,s.jsx)("h1",{children:"Access Denied"}),(0,s.jsx)("p",{children:"You don't have permission to access this page."}),(0,s.jsx)("button",{onClick:()=>a("/"),children:"Go Home"})]}):(0,s.jsxs)("div",{className:"add-products-container "+(t?"dark-mode":""),children:[(0,s.jsxs)("div",{className:"add-products-header",children:[(0,s.jsx)("h1",{children:"Product Management"}),(0,s.jsx)("p",{children:"Add, edit, and manage your products"})]}),d&&(0,s.jsx)("div",{className:"message "+(d.includes("successfully")?"success":"error"),children:d}),(0,s.jsxs)("div",{className:"admin-actions",children:[!y&&(0,s.jsx)(s.Fragment,{children:(0,s.jsx)("button",{className:"add-product-btn",onClick:()=>{u(!g),A(null)},children:g?"Cancel":"Add New Product"})}),(0,s.jsx)("button",{className:"categories-management-btn",onClick:()=>{x(!y),y||setTimeout(()=>{const e=document.querySelector(".categories-section");e&&e.scrollIntoView({behavior:"smooth"})},100)},title:"Manage product categories",children:y?"\u2b06\ufe0f Back to Top":"\ud83d\udcc2 Categories"})]}),g&&!y&&(0,s.jsxs)("div",{className:"product-form-container",children:[(0,s.jsx)("h2",{children:q?"Edit Product":"Add New Product"}),(0,s.jsxs)("form",{onSubmit:q?e=>{if(e.preventDefault(),!q.title||!q.price||!q.image||!q.quantity)return void m("Please fill in all required fields");if(q.isProtected&&!O())return void alert("\u274c Cannot edit protected products!\n\nOnly yahiapro400@gmail.com and yahiacool2009@gmail.com can edit protected products.");const t={...q,price:parseFloat(q.price),quantity:parseInt(q.quantity),updatedAt:(new Date).toISOString(),updatedBy:`${localStorage.getItem("currentUserEmail")||localStorage.getItem("loggedInUser")||localStorage.getItem("userEmail")||"Admin"} (Admin)`},a=S.map(e=>e.id===q.id?t:e);w(a);try{const e=a.slice(-50),t=JSON.stringify(e);localStorage.setItem("ecommerce_products",t),localStorage.setItem("products",t);if(!localStorage.getItem("ecommerce_products"))throw new Error("Failed to store products");console.log(`\u2705 Successfully updated product. ${e.length} products in localStorage`)}catch(o){console.error("Error updating product:",o),m("\u26a0\ufe0f Warning: Product updated but storage may be limited."),setTimeout(()=>m(""),5e3)}window.dispatchEvent(new Event("productsUpdated")),m(`\u2705 Product "${t.title}" updated successfully!`),A(null),u(!1),setTimeout(()=>m(""),3e3)}:e=>{if(e.preventDefault(),!k.title||!k.price||!k.image||!k.quantity)return void m("Please fill in all required fields");const t={id:Date.now(),title:k.title,price:parseFloat(k.price),quantity:parseInt(k.quantity),image:k.image,description:k.description,category:k.category,createdAt:(new Date).toISOString(),createdBy:`${localStorage.getItem("currentUserEmail")||localStorage.getItem("loggedInUser")||localStorage.getItem("userEmail")||"Admin"} (Admin)`,isProtected:U()},a=[...S,t];w(a);try{const e=a.map(e=>({id:e.id,title:e.title,price:e.price,quantity:e.quantity,image:e.image,description:e.description,category:e.category,createdAt:e.createdAt})),t=e.slice(-50),o=JSON.stringify(t);localStorage.setItem("ecommerce_products",o),localStorage.setItem("products",o);if(!localStorage.getItem("ecommerce_products"))throw new Error("Failed to store products");console.log(`\u2705 Successfully stored ${t.length} products in localStorage`)}catch(o){console.error("Error storing products:",o),m("\u26a0\ufe0f Warning: Product added but storage may be limited. Consider clearing some data."),setTimeout(()=>m(""),5e3)}window.dispatchEvent(new Event("productsUpdated")),m(`\u2705 Product "${t.title}" with ${t.quantity} pieces added successfully!`),J(),setTimeout(()=>{m(""),window.location.href="/"},2e3)},className:"product-form",children:[(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"title",children:"Product Title *"}),(0,s.jsx)("input",{type:"text",id:"title",name:"title",value:q?q.title:k.title,onChange:q?$:F,placeholder:"Enter product title",required:!0})]}),(0,s.jsxs)("div",{className:"form-row",children:[(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"price",children:"Price *"}),(0,s.jsx)("input",{type:"number",id:"price",name:"price",value:q?q.price:k.price,onChange:q?$:F,placeholder:"0.00",step:"0.01",min:"0",required:!0})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"quantity",children:"Quantity *"}),(0,s.jsx)("input",{type:"number",id:"quantity",name:"quantity",value:q?q.quantity:k.quantity,onChange:q?$:F,placeholder:"1",min:"1",required:!0})]})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"category",children:"Category *"}),(0,s.jsxs)("div",{className:"category-selector",children:[(0,s.jsxs)("button",{type:"button",className:"category-dropdown-btn",onClick:()=>N(!v),children:[q?q.category:k.category,(0,s.jsx)("span",{className:"dropdown-arrow",children:"\u25bc"})]}),v&&(0,s.jsx)("div",{className:"category-dropdown",children:b.map(e=>(0,s.jsx)("div",{className:"category-option",onClick:()=>{q?A(t=>({...t,category:e})):P(t=>({...t,category:e})),N(!1)},children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"image",children:"Product Image *"}),(0,s.jsxs)("div",{className:"image-upload-container",children:[(0,s.jsx)("input",{type:"text",id:"image",name:"image",value:q?q.image:k.image,onChange:q?$:F,placeholder:"Enter image URL (supports: jpg, png, webp, gif)",required:!0}),(0,s.jsx)("input",{type:"file",id:"imageFile",accept:"image/*",onChange:e=>{const t=e.target.files[0];if(t){const e=new FileReader;e.onload=e=>{q?A(t=>({...t,image:e.target.result})):P(t=>({...t,image:e.target.result}))},e.readAsDataURL(t)}},className:"file-input"}),(0,s.jsxs)("label",{htmlFor:"imageFile",className:"file-label",children:[(0,s.jsxs)("svg",{className:"upload-icon",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",children:[(0,s.jsx)("path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"}),(0,s.jsx)("polyline",{points:"7,10 12,15 17,10"}),(0,s.jsx)("line",{x1:"12",y1:"15",x2:"12",y2:"3"})]}),"Choose Image"]}),(q?q.image:k.image)&&(0,s.jsxs)("div",{className:"image-preview",children:[(0,s.jsx)("img",{src:q?q.image:k.image,alt:"Preview",loading:"eager",decoding:"async",onLoad:e=>{e.target.style.opacity="1"},style:{opacity:0,transition:"opacity 0.3s ease"}}),(0,s.jsx)("button",{type:"button",className:"remove-image",onClick:()=>{q?A(e=>({...e,image:""})):P(e=>({...e,image:""}))},children:"\xd7"})]})]})]}),(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"description",children:"Description"}),(0,s.jsx)("textarea",{id:"description",name:"description",value:q?q.description:k.description,onChange:q?$:F,rows:"4",placeholder:"Enter product description"})]}),(0,s.jsxs)("div",{className:"form-actions",children:[(0,s.jsx)("button",{type:"submit",className:"submit-btn",children:q?"Update Product":"Add Product"}),(0,s.jsx)("button",{type:"button",className:"cancel-btn",onClick:()=>{u(!1),A(null)},children:"Cancel"})]})]})]}),!y&&(0,s.jsxs)("div",{className:"products-section",children:[(0,s.jsx)("div",{className:"products-header",children:(0,s.jsxs)("h2",{children:["Products Management (",S.length,")"]})}),0===S.length?(0,s.jsx)("div",{className:"no-products",children:(0,s.jsx)("p",{children:"No products added yet."})}):(0,s.jsx)("div",{className:"products-grid",children:S.map(e=>(0,s.jsxs)("div",{className:"product-card",children:[(0,s.jsxs)("div",{className:"product-image",children:[(0,s.jsx)("img",{src:e.image,alt:e.title,loading:"eager",decoding:"async",fetchPriority:"high",onLoad:e=>{e.target.style.opacity="1",e.target.style.transform="scale(1)"},onError:e=>{e.target.style.display="none",e.target.nextSibling.style.display="block"},style:{opacity:0,transform:"scale(0.95)",transition:"all 0.3s ease"}}),(0,s.jsxs)("div",{className:"image-placeholder",style:{display:"none"},children:[(0,s.jsx)("span",{children:"\ud83d\udcf7"}),(0,s.jsx)("p",{children:"No Image"})]}),(0,s.jsx)("div",{className:"stock-status-overlay",children:0===e.quantity?(0,s.jsxs)("span",{className:"out-of-stock-overlay",children:[(0,s.jsx)("span",{className:"stock-icon",children:"\u274c"}),(0,s.jsx)("span",{className:"stock-text",children:"Out of Stock"})]}):e.quantity<=5?(0,s.jsxs)("span",{className:"low-stock-overlay",children:[(0,s.jsx)("span",{className:"stock-icon",children:"\u26a0\ufe0f"}),(0,s.jsx)("span",{className:"stock-text",children:"Low Stock"})]}):(0,s.jsxs)("span",{className:"in-stock-overlay",children:[(0,s.jsx)("span",{className:"stock-icon",children:"\u2705"}),(0,s.jsx)("span",{className:"stock-text",children:"In Stock"})]})}),e.updatedAt&&(0,s.jsx)("div",{className:"updated-badge",children:"Updated"}),e.isProtected&&(0,s.jsx)("div",{className:"protected-badge",children:"\ud83d\udd12 Protected"})]}),(0,s.jsxs)("div",{className:"product-info",children:[(0,s.jsx)("h3",{children:e.title}),(0,s.jsxs)("p",{className:"price",children:["$",e.price]}),(0,s.jsxs)("p",{className:"quantity",children:["Quantity: ",e.quantity||1]}),(0,s.jsx)("p",{className:"category",children:e.category}),e.description&&(0,s.jsx)("p",{className:"description",children:e.description}),(0,s.jsxs)("p",{className:"product-id",children:["ID: ",e.id]}),(0,s.jsxs)("p",{className:"created-date",children:["Created: ",new Date(e.createdAt).toLocaleDateString(),e.createdBy&&` by ${e.createdBy}`]}),e.updatedAt&&(0,s.jsxs)("p",{className:"updated-date",children:["Updated: ",new Date(e.updatedAt).toLocaleDateString(),e.updatedBy&&` by ${e.updatedBy}`]}),e.isProtected&&(0,s.jsx)("p",{className:"protected-info",children:"\ud83d\udd12 Protected Product - Only yahiapro400@gmail.com and yahiacool2009@gmail.com can modify"})]}),(0,s.jsxs)("div",{className:"product-actions",children:[(0,s.jsx)("button",{className:"edit-btn",onClick:()=>{A({...e,price:e.price.toString(),quantity:e.quantity.toString()}),u(!0)},title:"Edit Product",children:"\u270f\ufe0f Edit"}),(0,s.jsx)("button",{className:"delete-btn",onClick:()=>{const t=S.find(t=>t.id===e.id);if(t&&t.isProtected&&!O())alert("\u274c Cannot delete protected products!\n\nOnly yahiapro400@gmail.com and yahiacool2009@gmail.com can delete protected products.");else if(window.confirm("Are you sure you want to delete this product?")){const o=S.filter(t=>t.id!==e.id);w(o);try{const e=o.slice(-50),t=JSON.stringify(e);localStorage.setItem("ecommerce_products",t),localStorage.setItem("products",t);if(!localStorage.getItem("ecommerce_products"))throw new Error("Failed to store products");console.log(`\u2705 Successfully deleted product. ${e.length} products remaining in localStorage`)}catch(a){console.error("Error deleting product:",a),m("\u26a0\ufe0f Warning: Product deleted but storage may be limited."),setTimeout(()=>m(""),5e3)}window.dispatchEvent(new Event("productsUpdated")),m(`Product "${t.title}" deleted successfully! Remaining products: ${o.length}`),setTimeout(()=>m(""),3e3)}},title:"Delete Product",children:"\ud83d\uddd1\ufe0f Delete"})]})]},e.id))})]}),y&&(0,s.jsxs)("div",{className:"categories-section",children:[(0,s.jsxs)("div",{className:"categories-header",children:[(0,s.jsxs)("h2",{children:["Categories Management (",b.length,")"]}),(0,s.jsxs)("div",{className:"categories-actions",children:[(0,s.jsx)("button",{className:"add-category-btn",onClick:()=>f(!j),children:j?"Cancel":"\u2795 Add New Category"}),(0,s.jsx)("button",{className:"back-to-top-btn",onClick:()=>{window.scrollTo({top:0,behavior:"smooth"})},children:"\u2b06\ufe0f Back to Top"})]})]}),j&&(0,s.jsx)("div",{className:"category-form",children:(0,s.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!C.trim())return void m("Please enter a category name");const t=C.trim().toLowerCase();if(b.includes(t))return void m("This category already exists");const a=[...b,t];I(a),localStorage.setItem("ecommerce_categories",JSON.stringify(a)),E(""),f(!1),m(`Category "${t}" added successfully!`),setTimeout(()=>m(""),3e3)},children:[(0,s.jsxs)("div",{className:"form-group",children:[(0,s.jsx)("label",{htmlFor:"newCategory",children:"Category Name"}),(0,s.jsx)("input",{type:"text",id:"newCategory",value:C,onChange:e=>E(e.target.value),placeholder:"Enter category name",required:!0})]}),(0,s.jsx)("button",{type:"submit",className:"submit-btn",children:"Add Category"})]})}),(0,s.jsx)("div",{className:"categories-grid",children:b.map(e=>(0,s.jsxs)("div",{className:"category-card",children:[(0,s.jsxs)("div",{className:"category-info",children:[(0,s.jsx)("h3",{children:e.charAt(0).toUpperCase()+e.slice(1)}),(0,s.jsxs)("p",{children:["Products in this category: ",S.filter(t=>t.category===e).length]})]}),(0,s.jsx)("div",{className:"category-actions",children:(0,s.jsx)("button",{className:"delete-category-btn",onClick:()=>(e=>{if(window.confirm(`Are you sure you want to delete the category "${e}"? This will also remove it from all products.`))try{const t=b.filter(t=>t!==e);I(t),localStorage.setItem("ecommerce_categories",JSON.stringify(t));const a=S.map(t=>t.category===e?{...t,category:"Other"}:t);w(a),localStorage.setItem("ecommerce_products",JSON.stringify(a)),localStorage.setItem("products",JSON.stringify(a)),window.dispatchEvent(new Event("productsUpdated")),m(`\u2705 Category "${e}" deleted successfully! Products moved to "Other" category.`),setTimeout(()=>m(""),4e3),console.log(`\u2705 Category "${e}" deleted and products updated`)}catch(t){console.error("Error deleting category:",t),m("\u26a0\ufe0f Error deleting category"),setTimeout(()=>m(""),3e3)}})(e),disabled:"other"===e,title:"other"===e?"Cannot delete default category":"Delete category",children:"\ud83d\uddd1\ufe0f Delete"})})]},e))})]})]})}}}]);
//# sourceMappingURL=614.c6693154.chunk.js.map